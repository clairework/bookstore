"use strict";(self["webpackChunkbookstore"]=self["webpackChunkbookstore"]||[]).push([[135],{2913:function(t,a,e){e.d(a,{Z:function(){return x}});var s=e(3396),r=e(7139);const l={class:"zones section_process py-5"},o={class:"container"},i={class:"row justify-content-center"},n={class:"col-md-10"},c={class:"step-wrap"},d=(0,s._)("div",{class:"step step1 done"},[(0,s._)("h3",null,"1"),(0,s._)("span",{class:"txt"},"購物車")],-1),p=(0,s._)("h3",null,"2",-1),u=(0,s._)("span",{class:"txt"},"付款資訊",-1),_=[p,u],f=(0,s._)("h3",null,"3",-1),m=(0,s._)("span",{class:"txt"},"確認付款",-1),g=[f,m],h={class:"progress"};function b(t,a,e,p,u,f){return(0,s.wg)(),(0,s.iD)("section",l,[(0,s._)("div",o,[(0,s._)("div",i,[(0,s._)("div",n,[(0,s._)("div",c,[d,(0,s._)("div",{class:(0,r.C_)(["step step2",{done:2===e.step||3===e.step}])},_,2),(0,s._)("div",{class:(0,r.C_)(["step step3",{done:3===e.step}])},g,2)]),(0,s._)("div",h,[(0,s._)("div",{class:(0,r.C_)(["progress-bar bg-primary",{step2:2===e.step,step3:3===e.step}]),role:"progressbar","aria-valuenow":"50","aria-valuemin":"0","aria-valuemax":"100"},null,2)])])])])])}var y={data(){return{}},props:["step"]},w=e(89);const v=(0,w.Z)(y,[["render",b]]);var x=v},135:function(t,a,e){e.r(a),e.d(a,{default:function(){return at}});var s=e(3396),r=e(7139),l=e(9242);const o=t=>((0,s.dD)("data-v-6327a263"),t=t(),(0,s.Cn)(),t),i=o((()=>(0,s._)("div",{class:"spinner-border text-primaryDark m-5",role:"status"},[(0,s._)("span",{class:"visually-hidden"},"Loading...")],-1))),n={class:"front-checkcart"},c={class:"bg-light window-height"},d=o((()=>(0,s._)("div",{style:{height:"50px"}},null,-1))),p={class:"container"},u={class:"row"},_={class:"col-lg-8 pb-4"},f=o((()=>(0,s._)("div",{class:"mb-2",style:{"line-height":"1.57","border-bottom":"1px solid rgba(0, 0, 0, 0.12)","align-items":"baseline"}},[(0,s._)("i",{class:"fas fa-shopping-cart me-1 fs-3 text-gray600"}),(0,s._)("h2",{class:"fs-4 fs-md-2 d-inline-block text-gray600"},"購物車")],-1))),m={key:0,class:"w-100 d-flex flex-column align-items-center py-5"},g=o((()=>(0,s._)("i",{class:"fa-solid fa-triangle-exclamation text-primaryDark fa-2x mb-3"},null,-1))),h=o((()=>(0,s._)("p",{class:"fw-bold mb-4"},"購物車內沒有商品",-1))),b=[g,h],y={key:1},w=(0,s.uE)('<div class="card d-flex flex-row fs-5 shadow-sm text-gray600 bg-white border-0 d-flex justify-content-between mt-3 p-2 rounded-1" data-v-6327a263><span class="w-60" data-v-6327a263>名稱</span><span class="w-10" data-v-6327a263>售價</span><span class="w-20 text-center" data-v-6327a263>數量</span><span class="w-10" data-v-6327a263>金額</span></div>',1),v={class:"card border-0 my-4 text-gray600 shadow-sm"},x={class:"d-flex align-items-center p-3 fs-5"},D=["src","alt"],k={class:"fw-bold w-50"},C={class:"fw-bold h-100 text-end w-25 me-5"},q={class:"text-end cart-qty w-20"},V=["onUpdate:modelValue","disabled","onBlur"],$={class:"fw-bold text-primaryMiddle text-end w-25"},S=["onClick"],L=o((()=>(0,s._)("i",{class:"bi bi-trash me-2"},null,-1))),z={class:"col-lg-4"},I={key:0},P={class:"card fw-bold border-0 p-3 shadow text-gray600 mb-5"},U=o((()=>(0,s._)("h5",{class:"pb-2",style:{"border-bottom":"1px solid rgba(0, 0, 0, 0.12)"}},"訂單明細",-1))),Z={class:"float-end text-gray800 fw-bold"},M={key:0,class:"text-gray800 fs-5 mb-3"},N={class:"float-end"},O={class:"text-gray800 mb-3 fs-5",style:{"border-top":"1px solid rgba(0, 0, 0, 0.12)"}},B={class:"float-end text-secondaryDark fs-4"},E={key:1,class:"text-primary rounded-2 mb-2"},R={class:"fw-bold p-2"},j={class:"fs-5"},H={class:"input-group bg-primaryLight text-primary rounded-2 mb-2"},J={key:0,class:"input-group m-3"};function T(t,a,e,o,g,h){const T=(0,s.up)("LoadingView"),W=(0,s.up)("OrderSteps");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(T,{class:"loading",active:t.isLoading},{default:(0,s.w5)((()=>[i])),_:1},8,["active"]),(0,s._)("div",n,[(0,s._)("div",c,[(0,s.Wm)(W,{cartData:t.cartData,step:g.step},null,8,["cartData","step"]),d,(0,s._)("div",p,[(0,s._)("div",u,[(0,s._)("div",_,[f,0===t.cartData.carts.length?((0,s.wg)(),(0,s.iD)("div",m,b)):(0,s.kq)("",!0),0!==t.cartData.carts.length?((0,s.wg)(),(0,s.iD)("div",y,[w,((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(t.cartData.carts,(a=>((0,s.wg)(),(0,s.iD)("div",{class:"border-0",key:a.id},[(0,s._)("div",v,[(0,s._)("div",x,[(0,s._)("img",{class:"me-2",src:a.product.imageUrl,style:{height:"110px",width:"80px"},alt:a.product.title},null,8,D),(0,s._)("p",k,(0,r.zw)(a.product.title),1),(0,s._)("p",C,(0,r.zw)(t.$filters.currency(a.product.price)),1),(0,s._)("div",q,[(0,s.wy)((0,s._)("input",{class:"input-qty rounded-0 text-center fs-5",type:"number",min:"1",max:"30","onUpdate:modelValue":t=>a.qty=t,inputmode:"numeric",disabled:t.isDisabled===a.id,onBlur:e=>t.updateCart(a,a.qty)},null,40,V),[[l.nr,a.qty,void 0,{number:!0}]])]),(0,s._)("p",$,(0,r.zw)(t.$filters.currency(a.total)),1)]),(0,s._)("div",{class:"delCartItem text-end pe-3",onClick:e=>t.delCartItem(a),style:{cursor:"pointer","border-top":"1px solid rgba(0, 0, 0, 0.12)","line-height":"2.4rem"}},[L,(0,s.Uk)("刪除 ")],8,S)])])))),128))])):(0,s.kq)("",!0)]),(0,s._)("div",z,[0!==t.cartData.carts.length?((0,s.wg)(),(0,s.iD)("div",I,[(0,s._)("div",P,[U,(0,s._)("p",{class:(0,r.C_)(["fs-5 text-gray800 fw-bold",{"mb-3":t.cartData.final_total!==t.cartData.total}])},[(0,s.Uk)(" 商品小計 : "),(0,s._)("span",Z,"NT$ "+(0,r.zw)(t.$filters.currency(t.cartData.total)),1)],2),t.cartData.final_total!==t.cartData.total?((0,s.wg)(),(0,s.iD)("p",M,[(0,s.Uk)("折扣金額 : "),(0,s._)("span",N,(0,r.zw)(t.$filters.currency(g.discount_price)),1)])):(0,s.kq)("",!0),(0,s._)("p",O,[(0,s.Uk)("商品總金額: "),(0,s._)("span",B," NT$"+(0,r.zw)(t.$filters.currency(g.final_total)),1)]),t.cartData.final_total!==t.cartData.total?((0,s.wg)(),(0,s.iD)("div",E,[(0,s._)("div",R,[(0,s._)("p",j,"已使用 "+(0,r.zw)(t.$filters.currency(Math.abs(g.discount_price)))+" 元優惠券",1)])])):(0,s.kq)("",!0),(0,s._)("div",H,[t.cartData.final_total===t.cartData.total?((0,s.wg)(),(0,s.iD)("div",J,[t.cartData.final_total===t.cartData.total?(0,s.wy)(((0,s.wg)(),(0,s.iD)("input",{key:0,type:"text",class:"form-control",placeholder:"輸入優惠券","onUpdate:modelValue":a[0]||(a[0]=t=>g.coupon_code=t),"aria-label":"coupon","aria-describedby":"coupon"},null,512)),[[l.nr,g.coupon_code]]):(0,s.kq)("",!0),(0,s._)("button",{class:(0,r.C_)(["btn btn-primary text-white",{disabled:t.cartData.final_total!==t.cartData.total}]),type:"button",id:"coupon",onClick:a[1]||(a[1]=(...t)=>h.addCoupon&&h.addCoupon(...t))},"套用優惠券",2)])):(0,s.kq)("",!0)]),(0,s._)("button",{type:"submit",class:"btn btn-secondary text-primaryDark fw-bold fs-4 px-2",onClick:a[2]||(a[2]=(0,l.iM)(((...t)=>h.onSubmit&&h.onSubmit(...t)),["prevent"]))},"來去結帳")])])):(0,s.kq)("",!0)])])])])])],64)}e(7658);var W=e(2913),Y=e(2578),K=e(4677),A=e(6294),F=e(2492),G=e.n(F),Q={data(){return{step:1,final_total:"",discount_price:"",coupon_code:"",title:"建立訂單",form:{user:{payment:"",name:"",email:"",tel:"",address:""},message:""},orderId:this.$route.params.id,resentlyViewdProducts:JSON.parse(localStorage.getItem("resentlyViewdProducts"))||[]}},components:{OrderSteps:W.Z},watch:{cartData:{handler(){this.final_total=Math.round(this.cartData.final_total)},deep:!0},final_total:{handler(){this.discount_price=this.final_total-this.cartData.total},deep:!0}},computed:{...(0,Y.rn)(K.Z,["cartData","coupon_code"]),...(0,Y.rn)(A.Z,["isLoading"])},methods:{...(0,Y.nv)(K.Z,["getCartList","updateCart","delCartItem","addCouponCode"]),...(0,Y.nv)(A.Z,["loadingEffect","pushMsg"]),isPhone(t){const a=/^(09)[0-9]{8}$/;return!!a.test(t)||"需要正確的電話號碼"},onSubmit(){this.$router.push("/checkorder")},addCoupon(){const t="https://vue3-course-api.hexschool.io/api/claire0127-api/coupon",a={code:this.coupon_code};this.isLoading=!0,this.$http.post(t,{data:a}).then((t=>{this.getCartList(),console.log(t),this.isLoading=!1,G().fire({position:"center",icon:"success",title:"已套用優惠券!!!",showConfirmButton:!1,timer:2e3})}))},getResentlyViewdProducts(){this.resentlyViewdProducts=JSON.parse(localStorage.getItem("resentlyViewdProducts"))||[]},clearRecentlyViewed(){this.loadingEffect(),localStorage.removeItem("resentlyViewdProducts"),this.getResentlyViewdProducts()}},mounted(){this.final_total=Math.round(this.cartData.final_total),this.discount_price=this.final_total-this.cartData.total,console.log(this.discount_price)}},X=e(89);const tt=(0,X.Z)(Q,[["render",T],["__scopeId","data-v-6327a263"]]);var at=tt}}]);
//# sourceMappingURL=135.ebf01012.js.map