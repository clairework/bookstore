"use strict";(self["webpackChunkbookstore"]=self["webpackChunkbookstore"]||[]).push([[154],{2913:function(a,t,e){e.d(t,{Z:function(){return w}});var s=e(3396),l=e(7139);const r={class:"zones section_process py-5"},o={class:"container"},i={class:"row justify-content-center"},d={class:"col-md-10"},c={class:"step-wrap"},n=(0,s._)("div",{class:"step step1 done"},[(0,s._)("h3",null,"1"),(0,s._)("span",{class:"txt"},"購物車")],-1),p=(0,s._)("h3",null,"2",-1),m=(0,s._)("span",{class:"txt"},"付款資訊",-1),u=[p,m],b=(0,s._)("h3",null,"3",-1),f=(0,s._)("span",{class:"txt"},"確認付款",-1),_=[b,f],h={class:"progress"};function g(a,t,e,p,m,b){return(0,s.wg)(),(0,s.iD)("section",r,[(0,s._)("div",o,[(0,s._)("div",i,[(0,s._)("div",d,[(0,s._)("div",c,[n,(0,s._)("div",{class:(0,l.C_)(["step step2",{done:2===e.step||3===e.step}])},u,2),(0,s._)("div",{class:(0,l.C_)(["step step3",{done:3===e.step}])},_,2)]),(0,s._)("div",h,[(0,s._)("div",{class:(0,l.C_)(["progress-bar bg-primary",{step2:2===e.step,step3:3===e.step}]),role:"progressbar","aria-valuenow":"50","aria-valuemin":"0","aria-valuemax":"100"},null,2)])])])])])}var v={data(){return{}},props:["step"]},y=e(89);const x=(0,y.Z)(v,[["render",g]]);var w=x},602:function(a,t,e){e.r(t),e.d(t,{default:function(){return na}});var s=e(3396),l=e(7139),r=e(9242);const o=a=>((0,s.dD)("data-v-73b23dab"),a=a(),(0,s.Cn)(),a),i=o((()=>(0,s._)("div",{class:"spinner-border text-primaryDark m-5",role:"status"},[(0,s._)("span",{class:"visually-hidden"},"Loading...")],-1))),d={class:"front-check"},c={class:"bg-light"},n=o((()=>(0,s._)("div",{style:{height:"50px"}},null,-1))),p={class:"container"},m={class:"row"},u={class:"col-lg-8 pb-4"},b=(0,s.uE)('<div class="mb-2" style="line-height:1.57;border-bottom:1px solid rgba(0, 0, 0, 0.12);align-items:baseline;" data-v-73b23dab><h2 class="fs-4 fs-md-2 d-inline-block text-gray600" data-v-73b23dab>結帳資料填寫</h2></div><div class="bg-white p-4 mb-4" data-v-73b23dab><h3 class="pb-3 text-gray600 fs-4" style="border-bottom:1px solid rgba(0, 0, 0, 0.12);align-items:baseline;" data-v-73b23dab>付款方式</h3><select class="form-select form-select-lg my-3 w-40 border-gray300 text-gray600" aria-label=".form-select-lg example" style="font-size:18px;" data-v-73b23dab><option selected data-v-73b23dab>信用卡</option><option value="1" data-v-73b23dab>ATM 轉帳</option><option value="2" data-v-73b23dab>超商付款</option><option value="3" data-v-73b23dab>信用卡</option></select><p class="fs-5 text-gray600" data-v-73b23dab>下一步將連至第三方金流服務進行刷卡，你所有的交易資訊皆獲得安全保護。</p></div>',2),f={class:"bg-white mt-4 rounded-2 text-gray600"},_=o((()=>(0,s._)("h2",{class:"fs-4 fs-md-3 mb-3 pb-2",style:{"border-bottom":"1px solid rgba(0, 0, 0, 0.12)","align-items":"baseline"}},"填寫訂購人資料",-1))),h={classs:"row"},g={class:"mb-4 col-md-6 fs-5"},v=o((()=>(0,s._)("label",{for:"name",class:"form-label fs-5"},[(0,s.Uk)("訂購人姓名"),(0,s._)("span",{class:"text-danger"},"*")],-1))),y={class:"mb-4 col-md-6 fs-5"},x=o((()=>(0,s._)("label",{for:"Email",class:"form-label fs-5"},[(0,s.Uk)("聯絡用電子信箱"),(0,s._)("span",{class:"text-danger"},"*")],-1))),w={class:"mb-3"},k=o((()=>(0,s._)("label",{for:"tel",class:"form-label"},[(0,s.Uk)("訂購人電話"),(0,s._)("span",{class:"text-danger"},"*")],-1))),D={class:"mb-3",style:{height:"100px"}},V=o((()=>(0,s._)("label",{for:"address",class:"form-label"},[(0,s.Uk)("訂購人地址"),(0,s._)("span",{class:"text-danger"},"*")],-1))),C={class:"mb-3"},U=o((()=>(0,s._)("label",{for:"message",class:"form-label"},"備註",-1))),$={key:0,class:"w-100 d-flex flex-column align-items-center py-5"},W=o((()=>(0,s._)("i",{class:"fa-solid fa-triangle-exclamation text-primaryDark fa-2x mb-3"},null,-1))),z=o((()=>(0,s._)("p",{class:"fw-bold mb-4"},"購物車內沒有商品",-1))),E=[W,z],M={class:"col-lg-4"},S={class:"card border-0 p-3 shadow text-gray600 fw-bold"},P=o((()=>(0,s._)("h5",{class:"fw-bold pb-2",style:{"border-bottom":"1px solid rgba(0, 0, 0, 0.12)"}},"訂單明細",-1))),L={class:"float-end"},Z={key:0,class:"text-gray700 fs-5 mb-3"},q={class:"float-end"},I={class:"text-gray700 mb-3 fs-5",style:{"border-top":"1px solid rgba(0, 0, 0, 0.12)"}},N={class:"float-end text-secondaryDark fs-4"},O={key:1,class:"text-primary rounded-2 p-2 mb-2 fw-bold"},j={class:"fs-5"},R={class:"card bg-white mt-3 shadow border-0 p-3"},T={class:"table align-middle fs-6 bg-white"},H=o((()=>(0,s._)("h5",{class:"fw-bold pb-2 text-gray600",style:{"border-bottom":"1px solid rgba(0, 0, 0, 0.12)"}},"購買列表",-1))),J={class:"d-flex",style:{"border-bottom":"1px solid rgba(0, 0, 0, 0.12)"}},Y=["src","alt"],A={class:"flex-column justify-content-end"},B={class:"mb-3"},K={class:"text-gray600",style:{height:"80px",width:"260px"}},F={class:"d-flex flex-row justify-content-end"},G={class:"text-gray600 me-3"},Q={class:"fw-bold text-primaryMiddle"},X=o((()=>(0,s._)("div",null,null,-1)));function aa(a,t,e,o,W,z){const aa=(0,s.up)("LoadingView"),ta=(0,s.up)("OrderSteps"),ea=(0,s.up)("field-view"),sa=(0,s.up)("error-message"),la=(0,s.up)("form-view");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(aa,{class:"loading",active:a.isLoading},{default:(0,s.w5)((()=>[i])),_:1},8,["active"]),(0,s._)("div",d,[(0,s._)("div",c,[(0,s.Wm)(ta,{cartData:a.cartData,step:W.step},null,8,["cartData","step"]),n,(0,s._)("div",p,[(0,s._)("div",m,[(0,s._)("div",u,[b,(0,s._)("div",f,[(0,s.Wm)(la,{ref:"form",class:"p-4 p-md-8"},{default:(0,s.w5)((({errors:a})=>[_,(0,s._)("div",h,[(0,s._)("div",g,[v,(0,s.Wm)(ea,{id:"name",name:"姓名",type:"text",class:(0,l.C_)(["form-control rounded-2",{"is-invalid":a["姓名"]}]),placeholder:"請輸入姓名",rules:"required",modelValue:W.form.user.name,"onUpdate:modelValue":t[0]||(t[0]=a=>W.form.user.name=a)},null,8,["class","modelValue"]),(0,s.Wm)(sa,{name:"姓名",class:"invalid-feedback"})]),(0,s._)("div",y,[x,(0,s.Wm)(ea,{id:"Email",name:"Email",type:"Email",class:(0,l.C_)(["form-control rounded-2",{"is-invalid":a["Email"]}]),rules:"required",placeholder:"請輸入 Email",modelValue:W.form.user.email,"onUpdate:modelValue":t[1]||(t[1]=a=>W.form.user.email=a)},null,8,["class","modelValue"]),(0,s.Wm)(sa,{name:"Email",class:"invalid-feedback text-start"})]),(0,s._)("div",w,[k,(0,s.Wm)(ea,{id:"tel",name:"電話",type:"text",class:(0,l.C_)(["form-control rounded-2",{"is-invalid":a["電話"]}]),placeholder:"請輸入電話",rules:z.isPhone,modelValue:W.form.user.tel,"onUpdate:modelValue":t[2]||(t[2]=a=>W.form.user.tel=a)},null,8,["class","rules","modelValue"]),(0,s.Wm)(sa,{name:"電話",class:"invalid-feedback"})]),(0,s._)("div",D,[V,(0,s.Wm)(ea,{id:"address",name:"地址",type:"text",class:(0,l.C_)(["form-control rounded-2",{"is-invalid":a["地址"]}]),placeholder:"請輸入地址",rules:"required",modelValue:W.form.user.address,"onUpdate:modelValue":t[3]||(t[3]=a=>W.form.user.address=a)},null,8,["class","modelValue"]),(0,s.Wm)(sa,{name:"地址",class:"invalid-feedback"})]),(0,s._)("div",C,[U,(0,s.wy)((0,s._)("textarea",{id:"message",class:"form-control min-h-25 rounded-2","onUpdate:modelValue":t[4]||(t[4]=a=>W.form.message=a)},null,512),[[r.nr,W.form.message]])])])])),_:1},512)]),0===a.cartData.carts.length?((0,s.wg)(),(0,s.iD)("div",$,E)):(0,s.kq)("",!0)]),(0,s._)("div",M,[(0,s._)("div",S,[P,(0,s._)("p",{class:(0,l.C_)(["text-gray700 fs-5",{"mb-3":a.cartData.final_total!==a.cartData.total}])},[(0,s.Uk)(" 商品小計 : "),(0,s._)("span",L,(0,l.zw)(a.$filters.currency(a.cartData.total)),1)],2),a.cartData.final_total!==a.cartData.total?((0,s.wg)(),(0,s.iD)("p",Z,[(0,s.Uk)("折扣金額 : "),(0,s._)("span",q,(0,l.zw)(a.$filters.currency(W.discount_price)),1)])):(0,s.kq)("",!0),(0,s._)("p",I,[(0,s.Uk)("商品總金額: "),(0,s._)("span",N," NT$"+(0,l.zw)(a.$filters.currency(W.final_total)),1)]),a.cartData.final_total!==a.cartData.total?((0,s.wg)(),(0,s.iD)("div",O,[(0,s._)("p",j,"已使用 "+(0,l.zw)(a.$filters.currency(Math.abs(W.discount_price)))+" 元優惠券",1)])):(0,s.kq)("",!0),(0,s._)("button",{type:"submit",class:"btn btn-secondary text-primaryDark fw-bold fs-4 px-2",onClick:t[5]||(t[5]=(0,r.iM)(((...a)=>z.onSubmit&&z.onSubmit(...a)),["prevent"]))},"同意並送出")]),(0,s._)("div",R,[(0,s._)("div",T,[H,((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(a.cartData.carts,(t=>((0,s.wg)(),(0,s.iD)("div",{class:"d-flex",key:t.id},[(0,s._)("div",J,[(0,s._)("div",null,[(0,s._)("img",{class:"",style:{height:"120px",width:"90px"},src:t.product.imageUrl,alt:t.product.title},null,8,Y)]),(0,s._)("div",A,[(0,s._)("div",B,[(0,s._)("p",K,(0,l.zw)(t.product.title),1)]),(0,s._)("div",F,[(0,s._)("p",G,(0,l.zw)(t.qty)+" "+(0,l.zw)(t.product.unit),1),(0,s._)("p",Q,"NT$ "+(0,l.zw)(a.$filters.currency(t.product.price)),1)])])]),X])))),128))])])])])])])])],64)}e(7658);var ta=e(2913),ea=e(2578),sa=e(4677),la=e(6294),ra=e(2492),oa=e.n(ra),ia={data(){return{step:2,final_total:"",discount_price:"",title:"建立訂單",form:{user:{payment:"",name:"",email:"",tel:"",address:""},message:""},coupon_code:"",orderId:this.$route.params.id,resentlyViewdProducts:JSON.parse(localStorage.getItem("resentlyViewdProducts"))||[]}},components:{OrderSteps:ta.Z},watch:{cartData:{handler(){this.final_total=Math.round(this.cartData.final_total)},deep:!0},final_total:{handler(){this.discount_price=this.final_total-this.cartData.total},deep:!0}},computed:{...(0,ea.rn)(sa.Z,["cartData"]),...(0,ea.rn)(la.Z,["isLoading"])},methods:{...(0,ea.nv)(sa.Z,["getCartList","updateCart","delCartItem"]),...(0,ea.nv)(la.Z,["loadingEffect","pushMsg"]),isPhone(a){const t=/^(09)[0-9]{8}$/;return!!t.test(a)||"需要正確的電話號碼"},onSubmit(){0===this.cartData.carts.length?this.pushMsg(!1,"送出","購物車還是空的呢!"):this.$http.post("https://vue3-course-api.hexschool.io/api/claire0127-api/order",{data:this.form}).then((a=>{this.pushMsg(a,"送出","已成功送出訂單"),this.form.message="",this.getCartList(),this.$router.push(`/checkout/${a.data.orderId}`)})).catch((()=>{this.pushMsg(!1,"送出","送出訂單失敗")}))},addCoupon(){const a="https://vue3-course-api.hexschool.io/api/claire0127-api/coupon",t={code:this.coupon_code};this.isLoading=!0,this.$http.post(a,{data:t}).then((a=>{this.getCartList(),console.log(a),oa().fire({position:"center",icon:"success",title:"已套用優惠券!!!",showConfirmButton:!1,timer:2e3})}))},getResentlyViewdProducts(){this.resentlyViewdProducts=JSON.parse(localStorage.getItem("resentlyViewdProducts"))||[]},clearRecentlyViewed(){this.loadingEffect(),localStorage.removeItem("resentlyViewdProducts"),this.getResentlyViewdProducts()}},mounted(){this.final_total=Math.round(this.cartData.final_total),this.discount_price=this.final_total-this.cartData.total}},da=e(89);const ca=(0,da.Z)(ia,[["render",aa],["__scopeId","data-v-73b23dab"]]);var na=ca}}]);
//# sourceMappingURL=154.35d35e6f.js.map