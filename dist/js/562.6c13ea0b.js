"use strict";(self["webpackChunkbookstore"]=self["webpackChunkbookstore"]||[]).push([[562],{6614:function(t,e,a){a.d(e,{Z:function(){return w}});var s=a(3396),l=a(7139),i=a(9242);const r={"aria-label":"Page navigation"},o={class:"pagination d-flex align-items-center"},d=(0,s._)("span",{"aria-hidden":"true"},"«",-1),n=[d],p=["onClick"],c=(0,s._)("span",{"aria-hidden":"true"},"»",-1),m=[c];function g(t,e,a,d,c,g){return(0,s.wg)(),(0,s.iD)("nav",r,[(0,s._)("ul",o,[(0,s._)("li",{class:(0,l.C_)(["page-item",{disabled:!a.pages.has_pre}])},[(0,s._)("a",{class:"page-link",href:"#","aria-label":"Previous",onClick:e[0]||(e[0]=(0,i.iM)((e=>(t.$emit("update-page",a.pages.category,a.pages.current_page-1),g.goTop())),["prevent"]))},n)],2),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(a.pages.total_pages,((e,r)=>((0,s.wg)(),(0,s.iD)("li",{class:(0,l.C_)(["page-item",{active:e===a.pages.current_page}]),key:r},[(0,s._)("a",{class:(0,l.C_)(["page-link",{"pointer-none":e===a.pages.current_page}]),href:"#",onClick:(0,i.iM)((s=>(t.$emit("update-page",a.pages.category,e),g.goTop())),["prevent"])},(0,l.zw)(e),11,p)],2)))),128)),(0,s._)("li",{class:(0,l.C_)(["page-item",{disabled:!a.pages.has_next}])},[(0,s._)("a",{class:"page-link",href:"#","aria-label":"Next",onClick:e[1]||(e[1]=(0,i.iM)((e=>(t.$emit("update-page",a.pages.category,a.pages.current_page+1),g.goTop())),["prevent"]))},m)],2)])])}var u={props:["pages"],methods:{goTop(){document.documentElement.scrollTop=0}}},h=a(89);const _=(0,h.Z)(u,[["render",g]]);var w=_},6562:function(t,e,a){a.r(e),a.d(e,{default:function(){return jt}});var s=a(3396),l=a(7139),i=a(9242);const r=(0,s._)("div",{class:"spinner-border text-primaryLight m-5",role:"status"},[(0,s._)("span",{class:"visually-hidden"},"Loading...")],-1),o={class:"container",style:{"min-height":"74vh"}},d=(0,s._)("h2",{class:"text-gray700 fw-bold me-4 p-2 py-5 text-center"},"訂單管理",-1),n={class:"overflow-auto mb-3 table-responsive rounded-2"},p={class:"table admin-order caption-top table-hover text-gray600 text-nowrap"},c=(0,s._)("thead",null,[(0,s._)("tr",{class:"bg-primary fs-5 text-white"},[(0,s._)("th",{scope:"col"},"購買時間"),(0,s._)("th",{scope:"col"},"Email"),(0,s._)("th",{scope:"col"},"購買項目"),(0,s._)("th",{scope:"col"},"應付金額"),(0,s._)("th",{scope:"col"},"是否付款"),(0,s._)("th",{scope:"col"},"編輯"),(0,s._)("th",{scope:"col"},"刪除")])],-1),m={class:"bg-white"},g={class:"list-unstyled text-gray600"},u={class:"d-flex justify-content-start mb-2"},h=["src"],_={class:"text-wrap me-2 text-gray600",style:{width:"220px"}},w={class:"text-end text-gray600",style:{width:"20px"}},x={class:"text-end"},y={class:"ps-2 text-gray600"},f={class:"switch"},b=["onUpdate:modelValue","onChange"],D=(0,s._)("span",{class:"slider"},null,-1),k=["onClick"],v=(0,s._)("i",{class:"bi bi-pencil-square cursor-pointer text-primaryDark fs-4 me-6"},null,-1),M=[v],$=["onClick"],z=(0,s._)("i",{class:"bi bi-trash cursor-pointer text-primaryDark fs-4"},null,-1),C=[z];function L(t,e,a,v,z,L){const O=(0,s.up)("LoadingView"),P=(0,s.up)("OrderModal"),U=(0,s.up)("DelModal"),T=(0,s.up)("PagiNation");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(O,{class:"loading",active:z.isLoading},{default:(0,s.w5)((()=>[r])),_:1},8,["active"]),(0,s._)("div",o,[d,(0,s._)("div",n,[(0,s._)("table",p,[c,(0,s._)("tbody",m,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(z.orders,(e=>((0,s.wg)(),(0,s.iD)("tr",{key:e.id},[(0,s._)("td",null,(0,l.zw)(t.$filters.date(e.create_at)),1),(0,s._)("td",null,(0,l.zw)(e.user.email),1),(0,s._)("td",null,[(0,s._)("ul",g,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.products,((t,e)=>((0,s.wg)(),(0,s.iD)("li",{key:e},[(0,s._)("div",u,[(0,s._)("img",{class:"img-wrap me-2",src:t.product.imageUrl},null,8,h),(0,s._)("span",_,(0,l.zw)(t.product.title),1),(0,s._)("span",w," x "+(0,l.zw)(t.qty)+" 本 ",1)])])))),128))])]),(0,s._)("td",x,"NT$"+(0,l.zw)(t.$filters.currency(Math.round(e.total))),1),(0,s._)("td",y,[(0,s._)("label",f,[(0,s.wy)((0,s._)("input",{type:"checkbox",class:"text-gray600","onUpdate:modelValue":t=>e.is_paid=t,onChange:t=>L.updatePaid(e)},null,40,b),[[i.e8,e.is_paid]]),D])]),(0,s._)("td",null,[(0,s._)("div",{class:"d-flex align-items-center",onClick:t=>L.openModal("edit",e)},M,8,k)]),(0,s._)("td",null,[(0,s._)("div",{class:"d-flex align-items-center",onClick:t=>L.openModal("delete",e)},C,8,$)])])))),128))])])])]),(0,s.Wm)(P,{ref:"orderModal",temp:z.temp,onUpdateOrders:L.updatePaid},null,8,["temp","onUpdateOrders"]),(0,s.Wm)(U,{ref:"delModal",temp:z.temp,onDelItem:L.delOrderItem},null,8,["temp","onDelItem"]),(0,s.Wm)(T,{class:"d-flex justify-content-center pb-3",pages:z.pagination,onUpdatePage:L.getOrders},null,8,["pages","onUpdatePage"])],64)}var O=a(2578),P=a(6294),U=a(6614);const T={class:"modal fade",ref:"modal",tabindex:"-1"},Z={class:"modal-dialog modal-dialog-centered modal-xl"},q={class:"modal-content background-transparent"},N={class:"modal-header bg-primaryLight text-center p-3"},j={class:"modal-title text-dark"},H={class:"modal-body bg-white text-center p-6"},Y={class:"row"},I={class:"col-10 col-md-5 offset-1"},K={class:"d-flex justify-content-between align-items-center mb-4"},V=(0,s._)("p",{class:"text-primaryDark fw-bold fs-3 p-2"},"訂單內容",-1),W={class:"d-flex mt-3"},E={key:0,class:"text-primaryDark fw-bold me-2"},S={key:1,class:"text-primaryDark fw-bold me-2"},A={class:"switch"},B=(0,s._)("span",{class:"slider"},null,-1),F={class:"d-flex align-items-center"},G=["src","alt"],J={class:"cart-body text-start"},Q={class:"fw-bold"},R={class:"fw-bold text-primaryDark"},X={key:0,class:"text-danger fw-bold"},tt={class:"fs-4 fw-bold text-end"},et={class:"col-10 col-md-5 bg-light shadow-sm ms-5"},at={class:"position-sticky top-20"},st=(0,s._)("div",{class:"d-flex justify-content-between align-items-center"},[(0,s._)("p",{class:"bg-light text-primaryDark fw-bold fs-3 p-2"},"用戶資訊")],-1),lt={class:"table mt-4 fs-6"},it={class:"text-start"},rt=(0,s._)("th",{class:"text-primaryDark",scope:"row"},"下單時間",-1),ot={class:"text-primaryDark"},dt={class:"text-start"},nt=(0,s._)("th",{class:"text-primaryDark",scope:"row"},"Email",-1),pt={class:"text-primaryDark"},ct={class:"text-start"},mt=(0,s._)("th",{class:"text-primaryDark",scope:"row"},"收件人姓名",-1),gt={class:"text-primaryDark"},ut={class:"text-start"},ht=(0,s._)("th",{class:"text-primaryDark",scope:"row"},"電話號碼",-1),_t={class:"text-primaryDark"},wt={class:"text-start"},xt=(0,s._)("th",{class:"text-primaryDark",scope:"row"},"收件地址",-1),yt={class:"text-primaryDark"},ft={key:0,class:"text-start"},bt=(0,s._)("th",{class:"text-primaryDark",scope:"row"},"付款方式",-1),Dt={class:"text-primaryDark"},kt={key:1,class:"text-start"},vt=(0,s._)("th",{class:"text-primaryDark",scope:"row"},"備註",-1),Mt={class:"text-primaryDark"},$t={class:"modal-footer flex-nowrap w-100"},zt=(0,s._)("button",{type:"button",class:"btn btn-outline-primary","data-bs-dismiss":"modal"},"取消",-1);function Ct(t,e,a,r,o,d){return(0,s.wg)(),(0,s.iD)("div",T,[(0,s._)("div",Z,[(0,s._)("div",q,[(0,s._)("div",N,[(0,s._)("h4",j,"訂單編號 : "+(0,l.zw)(t.tempModalData.id),1)]),(0,s._)("div",H,[(0,s._)("div",Y,[(0,s._)("div",I,[(0,s._)("div",K,[V,(0,s._)("div",W,[t.tempModalData.is_paid?((0,s.wg)(),(0,s.iD)("span",E,"已付款")):((0,s.wg)(),(0,s.iD)("span",S,"未付款")),(0,s._)("label",A,[(0,s.wy)((0,s._)("input",{type:"checkbox","onUpdate:modelValue":e[0]||(e[0]=e=>t.tempModalData.is_paid=e)},null,512),[[i.e8,t.tempModalData.is_paid]]),B])])]),(0,s._)("ul",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(t.tempModalData.products,(t=>((0,s.wg)(),(0,s.iD)("li",{class:"d-flex justify-content-between align-items-center py-2",key:t.id},[(0,s._)("div",F,[(0,s._)("img",{class:"img-wrap me-4",src:t.product.imageUrl,alt:t.product.title},null,8,G),(0,s._)("div",J,[(0,s._)("p",Q,(0,l.zw)(t.product.title),1),(0,s._)("p",R,"NT$ "+(0,l.zw)(Math.round(t.final_total)),1),t.coupon?((0,s.wg)(),(0,s.iD)("p",X,"已套用優惠券")):(0,s.kq)("",!0)])]),(0,s._)("div",null,[(0,s._)("p",null,"x "+(0,l.zw)(t.qty),1)])])))),128))]),(0,s._)("p",tt," 總計金額:NT$"+(0,l.zw)(Math.round(t.tempModalData.total)),1)]),(0,s._)("div",et,[(0,s._)("div",at,[st,(0,s._)("table",lt,[(0,s._)("tbody",null,[(0,s._)("tr",it,[rt,(0,s._)("td",ot,(0,l.zw)(this.$filters.date(t.tempModalData.create_at)),1)]),(0,s._)("tr",dt,[nt,(0,s._)("td",pt,(0,l.zw)(t.tempModalData.user?.email),1)]),(0,s._)("tr",ct,[mt,(0,s._)("td",gt,(0,l.zw)(t.tempModalData.user?.name),1)]),(0,s._)("tr",ut,[ht,(0,s._)("td",_t,(0,l.zw)(t.tempModalData.user?.tel),1)]),(0,s._)("tr",wt,[xt,(0,s._)("td",yt,(0,l.zw)(t.tempModalData.user?.address),1)]),t.tempModalData.user?.payment?((0,s.wg)(),(0,s.iD)("tr",ft,[bt,(0,s._)("td",Dt,(0,l.zw)(t.tempModalData.user?.payment),1)])):(0,s.kq)("",!0),t.tempModalData.message?((0,s.wg)(),(0,s.iD)("tr",kt,[vt,(0,s._)("td",Mt,(0,l.zw)(t.tempModalData.message),1)])):(0,s.kq)("",!0)])])])])])]),(0,s._)("div",$t,[zt,(0,s._)("button",{type:"button",class:"btn btn-primary text-white",onClick:e[1]||(e[1]=e=>t.$emit("update-orders",t.tempModalData))},"確定修改")])])])],512)}var Lt=a(1339),Ot={mixins:[Lt.Z],watch:{temp:{handler(){this.tempModalData.orderStatus||(this.tempModalData.orderStatus="已收到訂單")},deep:!0}}},Pt=a(89);const Ut=(0,Pt.Z)(Ot,[["render",Ct]]);var Tt=Ut,Zt=a(5384),qt={data(){return{temp:[],orders:[],pagination:[],isLoading:!1}},components:{PagiNation:U.Z,OrderModal:Tt,DelModal:Zt.Z},methods:{...(0,O.nv)(P.Z,["pushMsg"]),getOrders(t=1){this.isLoading=!0,this.$http.get(`https://vue3-course-api.hexschool.io/api/claire0127-api/admin/orders?page=${t}`).then((t=>{this.orders=t.data.orders,this.pagination=t.data.pagination,this.isLoading=!1})).catch((()=>{this.isLoading=!1}))},openModal(t,e){"edit"===t?(this.temp={...e},this.$refs.orderModal.openModal()):"delete"===t&&(this.temp={...e},this.$refs.delModal.openModal())},updatePaid(t){this.temp=t,this.isLoading=!0,this.$http.put(`https://vue3-course-api.hexschool.io/api/claire0127-api/admin/order/${t.id}`,{data:this.temp}).then((t=>{this.pushMsg(t,"更新","已成功更新付款狀態"),this.isLoading=!1,this.$refs.orderModal.hideModal(),this.getOrders()})).catch((()=>{this.pushMsg(!1,"更新","更新付款狀態失敗"),this.isLoading=!1}))},delOrderItem(t){this.isLoading=!0,this.$http.delete(`https://vue3-course-api.hexschool.io/api/claire0127-api/admin/order/${t.id}`).then((t=>{this.pushMsg(t,"更新","已成功刪除訂單"),this.isLoading=!1,this.$refs.delModal.hideModal(),this.getOrders()})).catch((()=>{this.pushMsg(!1,"更新","刪除訂單失敗"),this.isLoading=!1}))}},mounted(){this.getOrders()}};const Nt=(0,Pt.Z)(qt,[["render",L]]);var jt=Nt}}]);
//# sourceMappingURL=562.6c13ea0b.js.map